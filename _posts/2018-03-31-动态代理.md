---
title: 动态代理
date: 2018-03-31
categories: java
tags:
- 动态代理
---


代理模式是我们常用到的一种设计模式，代理模式中，还分为静态代理和动态代理。

<!---begin--->


静态代理
----


我们日常用到的代理模式就是静态代理，这个很简单，就是Proxy类，Real类，和接口类。
Proxy和Real都实现接口，一般是Proxy内部持有Real类。
静态代理的优点是可以做到在不修改目标对象的功能前提下,对目标功能扩展.
他的缺点是因为代理对象需要与目标对象实现一样的接口,所以会有很多代理类,类太多.同时,一旦接口增加方法,目标对象与代理对象都要维护.


动态代理
----

动态生成代理类，主要用到：static Object newProxyInstance(ClassLoader loader, Class<?>[] interfaces,InvocationHandler h )
ClassLoader loader,:指定当前目标对象使用类加载器,获取加载器的方法是固定的
Class<?>[] interfaces,:目标对象实现的接口的类型,使用泛型方式确认类型
InvocationHandler h:事件处理,执行目标对象的方法时,会触**发事件处理器**的方法,会把当前执行目标对象的方法作为参数传入

特点：
1.代理对象,不需要实现接口
2.代理对象的生成,是利用JDK的API,动态的在内存中构建代理对象(需要我们指定创建代理对象/目标对象实现的接口的类型)
3.动态代理也叫做:JDK代理,接口代理

总结
--

在代理模式中代理对象和被代理对象一般实现相同的接口，调用者与代理对象进行交互。代理的存在对于调用者来说是透明的，调用者看到的只是接口。这就是传统的代理模式静态代理的特点。
而动态代理我们可以动态创建代理类，不用繁琐的管理代理类，而且可以实现：
数据库连接以及事物管理
单元测试中的动态 Mock 对象
自定义工厂与依赖注入（DI）容器之间的适配器
类似 AOP 的方法拦截器
日志、缓存等业务增强
Java RMI远程通信
各种访问控制器、验证器