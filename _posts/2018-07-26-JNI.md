---
title: JNI
date: 2018-07-23
categories: java
tags:
- JNI
---

JNI全程 Java Native Interface，是 Java 平台的一个特性，主要是定义一些JNI函数，让 c/c++ 和 java 可以互相调用。今天因为用到了，就简单写一份总结。


<!---begin--->


首先要介绍下背景知识：


**1.程序从我们写的代码到最后执行的过程。**
①编译：高级语言转换成汇编语言。
②汇编：汇编语言变成机器码。
③连接：将多段机器码合成一个可执行程序。


**2.库**
库从本质上来说是一种可执行代码的二进制格式，可以被载入内存中执行。库分静态库和动态库两种。


**静态库**：这类库的名字一般是libxxx.a，xxx为库的名字。利用静态函数库编译成的文件比较大，因为整个函数库的所有数据都会被整合进目标代码中，他的优点就显而易见了，即编译后的执行程序不需要外部的函数库支持，因为所有使用的函数都已经被编译进去了。当然这也会成为他的缺点，因为如果静态函数库改变了，那么你的程序必须重新编译。


**动态库**：这类库的名字一般是libxxx.M.N.so，同样的xxx为库的名字，M是库的主版本号，N是库的副版本号。当然也可以不要版本号，但名字必须有。相对于静态函数库，动态函数库在编译的时候并没有被编译进目标代码中，你的程序执行到相关函数时才调用该函数库里的相应函数，因此动态函数库所产生的可执行文件比较小。由于函数库没有被整合进你的程序，而是程序运行时动态的申请并调用，所以程序的运行环境中必须提供相应的库。动态函数库的改变并不影响你的程序，所以动态函数库的升级比较方便。linux系统有几个重要的目录存放相应的函数库。
window中的库文件 .dll（动态库）
linux .so（动态库） .a（静态库）


在说下在Android中怎么使用JNI。
1.在类中编写Native方法。
2.生成JNI方法的头文件。
3.编写JNI方法。
4.新建Android.mk文件。（指定动态库名字、位置，C的源文件）/CakeLists.txt文件。

简单来说就是编写Native方法，然后生成对应方法的so库。

第四步的不同是使用不同的方法生成so库，前者是使用NDK生成so库，[参考](https://www.jianshu.com/p/28d541d658db)，后者是使用cMake生成so库，[参考](https://www.jianshu.com/p/912fe0b73f16)。